# Thai Word Chinese Word - Tour Management System

‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ß‡∏£‡πå‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤, ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á, ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° leads, ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì commission ‡πÅ‡∏•‡∏∞‡∏≠‡∏∑‡πà‡∏ô‡πÜ

## üìñ Requirements

‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î requirements ‡πÅ‡∏•‡∏∞ specification ‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏î‡∏π‡∏ó‡∏µ‡πà:

**[CRM Requirement Document](https://docs.google.com/document/d/1mJdb-AcCFOqGPiYeAfjXbdriurfON3YkuV2vHc3aXu4/edit?tab=t.0#heading=h.13i932ugf6iw)**

‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢:
- Functional Requirements
- System Specifications
- User Stories
- ‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á

## üìã ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç

- [Requirements](#-requirements)
- [‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏Å](#-‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏Å)
- [‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ](#-‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ)
- [‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á](#-‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á)
- [‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤](#-‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤)
- [‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô](#-‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)
- [‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ](#-‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ)
- [API Documentation](#-api-documentation)
- [‡∏Å‡∏≤‡∏£ Deploy](#-‡∏Å‡∏≤‡∏£-deploy)
- [Workflow](#-workflow)
- [Troubleshooting](#-troubleshooting)

## ‚ú® ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏Å

### üë• User Management
- ‡∏£‡∏∞‡∏ö‡∏ö Authentication ‡πÅ‡∏•‡∏∞ Authorization ‡πÅ‡∏ö‡∏ö Role-based
- ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö 4 roles: `SUPER_ADMIN`, `ADMIN`, `SALES`, `STAFF`
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô, ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô, ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
- Email verification ‡πÅ‡∏•‡∏∞ password reset

### üßë‚Äçü§ù‚Äçüßë Customer Management
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ó‡∏¢/‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©, ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î, ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠)
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Passport (‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏•‡πà‡∏°‡∏ï‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà (Address)
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Food Allergies
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß (Families)
- Tag system ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤

### üéØ Lead Management
- ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° Leads ‡∏à‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á (Facebook, Website, LINE, etc.)
- Lead status pipeline (INTERESTED, QUOTED, BOOKED, COMPLETED, CANCELLED)
- Auto-sync lead status ‡∏à‡∏≤‡∏Å booking status
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏î‡∏¥‡∏°

### ‚úàÔ∏è Trip Management
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏¥‡∏õ (‡∏ä‡∏∑‡πà‡∏≠, ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà, ‡∏£‡∏≤‡∏Ñ‡∏≤, ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô)
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Airline ‡πÅ‡∏•‡∏∞ Airport (IATA codes)
- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤ standard ‡πÅ‡∏•‡∏∞ extra prices

### üìÖ Booking Management
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏£‡∏¥‡∏õ
- ‡∏£‡∏∞‡∏ö‡∏ö Payment ‡πÅ‡∏ö‡∏ö 3 ‡∏á‡∏ß‡∏î (First, Second, Third Payment)
- Payment status tracking (DEPOSIT_PENDING, DEPOSIT_PAID, FULLY_PAID, CANCELLED)
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Companion Customers
- Extra prices (Single Traveller, Bed, Seat, Bag)
- Discount management
- Room type ‡πÅ‡∏•‡∏∞ Seat class selection

### üí∞ Commission Management
- ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì commission ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠ booking ‡πÄ‡∏õ‡πá‡∏ô FULLY_PAID
- ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° commission ‡∏ï‡∏≤‡∏° sales user
- Filter ‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô commission
- ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ADMIN ‡πÅ‡∏•‡∏∞ SUPER_ADMIN

### ‚úÖ Task Management
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Tasks ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏á‡∏≤‡∏ô
- Task status (TODO, IN_PROGRESS, COMPLETED, CANCELLED)
- Contact method tracking (CALL, LINE, MESSENGER)
- ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏Å‡∏±‡∏ö Customer

### üîî Notifications
- ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
- Passport expiry alerts
- Upcoming trip alerts
- Cron job ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö generate alerts

### üè∑Ô∏è Master Data
- Tag management
- Airline & Airport (IATA codes) management

## üõ†Ô∏è ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ

### Frontend
- **Next.js 16** - React framework with App Router
- **React 19** - UI library
- **TypeScript** - Type safety
- **Tailwind CSS** - Styling
- **Shadcn/ui** - UI component library
- **TanStack Query** - Data fetching ‡πÅ‡∏•‡∏∞ caching
- **React Hook Form** - Form management
- **Zod** - Schema validation
- **date-fns** - Date manipulation
- **Decimal.js** - Precise decimal calculations

### Backend
- **Next.js API Routes** - Server-side API
- **Prisma** - ORM
- **PostgreSQL** - Database
- **NextAuth.js** - Authentication
- **bcryptjs** - Password hashing

### Other Tools
- **Google Drive API** - File upload
- **Resend** - Email service
- **Sonner** - Toast notifications

## üì¶ ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á

### Prerequisites
- Node.js 18+ 
- PostgreSQL 14+
- npm, yarn, pnpm ‡∏´‡∏£‡∏∑‡∏≠ bun

### Steps

1. **Clone repository**
```bash
git clone <repository-url>
cd the-trip
```

2. **Install dependencies**
```bash
npm install
# ‡∏´‡∏£‡∏∑‡∏≠
pnpm install
# ‡∏´‡∏£‡∏∑‡∏≠
yarn install
```

3. **Setup environment variables**
```bash
cp .env.example .env.local
```

‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `.env.local` ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ (‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÉ‡∏ô [‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤](#‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤))

4. **Setup database**
```bash
# Generate Prisma Client
npm run prisma:generate

# Run migrations
npm run prisma:migrate

# Seed database (optional)
npm run prisma:seed
```

5. **Run development server**
```bash
npm run dev
```

‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏õ‡∏ó‡∏µ‡πà [http://localhost:3000](http://localhost:3000)

## ‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤

### Environment Variables

‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `.env.local` ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ:

#### Database
```env
DATABASE_URL="postgresql://user:password@localhost:5432/the_trip?schema=public"
```

#### NextAuth
```env
NEXTAUTH_URL="http://localhost:3000"
NEXTAUTH_SECRET="your-secret-key-here"
```

#### Email (Resend)
```env
RESEND_API_KEY="your-resend-api-key"
EMAIL_FROM="noreply@yourdomain.com"
```

#### Google Drive (Optional - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö file upload)
```env
GOOGLE_DRIVE_CLIENT_EMAIL="your-service-account-email@project.iam.gserviceaccount.com"
GOOGLE_DRIVE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"
GOOGLE_DRIVE_PROJECT_ID="your-project-id"
GOOGLE_DRIVE_ROOT_FOLDER_ID="your-shared-folder-id"
```

### Database Setup

1. **Create PostgreSQL database**
```sql
CREATE DATABASE the_trip;
```

2. **Run migrations**
```bash
npm run prisma:migrate
```

3. **Seed initial data (optional)**
```bash
npm run prisma:seed
```

## üöÄ ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### Development

```bash
# Start development server
npm run dev

# Run Prisma Studio (Database GUI)
npm run prisma:studio

# Run linting
npm run lint
```

### Production Build

```bash
# Build for production
npm run build

# Start production server
npm start
```

### Database Commands

```bash
# Generate Prisma Client
npm run prisma:generate

# Create new migration
npm run prisma:migrate

# Reset database (‚ö†Ô∏è ‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)
npm run prisma:reset

# Seed database
npm run prisma:seed
```

## üìÅ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ

```
the-trip/
‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îú‚îÄ‚îÄ schema.prisma          # Database schema
‚îÇ   ‚îú‚îÄ‚îÄ seed.ts                # Seed data
‚îÇ   ‚îî‚îÄ‚îÄ migrations/            # Database migrations
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/               # API routes
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/          # Authentication endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ bookings/      # Booking endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ customers/     # Customer endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ leads/         # Lead endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ trips/         # Trip endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tasks/         # Task endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ commissions/   # Commission endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cron/          # Cron jobs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/         # Dashboard pages
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ bookings/      # Booking management
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ customers/     # Customer management
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ leads/         # Lead management
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ trips/         # Trip management
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tasks/         # Task management
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ commissions/   # Commission reports
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ admin/         # Admin panel
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login/             # Login page
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ layout.tsx         # Root layout
‚îÇ   ‚îú‚îÄ‚îÄ components/            # Reusable components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/                # Shadcn/ui components
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ upload-image/      # File upload component
‚îÇ   ‚îú‚îÄ‚îÄ lib/                   # Utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prisma.ts          # Prisma client
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.ts            # Auth configuration
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ services/          # Business logic
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ commission-calculator.ts
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ lead-sync.ts
‚îÇ   ‚îî‚îÄ‚îÄ navigation/            # Navigation config
‚îú‚îÄ‚îÄ public/                     # Static files
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ tailwind.config.ts
‚îî‚îÄ‚îÄ next.config.ts
```

## üìö API Documentation

### Authentication
- `POST /api/auth/login` - Login
- `POST /api/auth/logout` - Logout
- `GET /api/auth/me` - Get current user
- `POST /api/auth/reset-password` - Request password reset
- `POST /api/auth/change-password` - Change password

### Customers
- `GET /api/customers` - List customers (with pagination & filters)
- `POST /api/customers` - Create customer
- `GET /api/customers/[id]` - Get customer details
- `PUT /api/customers/[id]` - Update customer
- `DELETE /api/customers/[id]` - Delete customer

### Bookings
- `GET /api/bookings` - List bookings (with pagination & filters)
- `POST /api/bookings` - Create booking
- `GET /api/bookings/[id]` - Get booking details
- `PUT /api/bookings/[id]` - Update booking
- `POST /api/payments` - Create payment

### Leads
- `GET /api/leads` - List leads (with pagination & filters)
- `POST /api/leads` - Create lead
- `GET /api/leads/[id]` - Get lead details
- `PUT /api/leads/[id]` - Update lead

### Trips
- `GET /api/trips` - List trips (with filters)
- `POST /api/trips` - Create trip
- `GET /api/trips/[id]` - Get trip details
- `PUT /api/trips/[id]` - Update trip

### Tasks
- `GET /api/tasks` - List tasks (with pagination & filters)
- `POST /api/tasks` - Create task
- `GET /api/tasks/[id]` - Get task details
- `PUT /api/tasks/[id]` - Update task
- `DELETE /api/tasks/[id]` - Delete task

### Commissions
- `GET /api/commissions` - Get commission summary (ADMIN only)
- `GET /api/commissions/[agentId]` - Get commission details for agent

### Cron Jobs
- `GET /api/cron/alerts` - Generate alerts (passport expiry, upcoming trips)

## üö¢ ‡∏Å‡∏≤‡∏£ Deploy

### Vercel (Recommended)

1. Push code ‡πÑ‡∏õ‡∏¢‡∏±‡∏á GitHub
2. Import project ‡πÉ‡∏ô Vercel
3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variables
4. Deploy

### Docker

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡∏ô‡∏µ‡πâ‡∏°‡∏µ `docker-compose.yml` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏ô PostgreSQL:

```bash
# Start PostgreSQL
docker-compose up -d

# Stop PostgreSQL
docker-compose down
```

‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö production deployment:

```bash
# Build image
docker build -t the-trip .

# Run container
docker run -p 3000:3000 --env-file .env.local the-trip
```

### Environment Variables ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Production

‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ‡πÉ‡∏ô production environment:

- `DATABASE_URL` - Production database URL
- `NEXTAUTH_URL` - Production URL
- `NEXTAUTH_SECRET` - Strong secret key
- `RESEND_API_KEY` - Email service API key
- ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ

## üîê Security

- Password hashing ‡∏î‡πâ‡∏ß‡∏¢ bcryptjs
- Role-based access control (RBAC)
- Session management ‡∏î‡πâ‡∏ß‡∏¢ NextAuth
- SQL injection protection ‡∏î‡πâ‡∏ß‡∏¢ Prisma
- Environment variables ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö sensitive data

## üß™ Testing

```bash
# Run tests (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
npm test

# Run linting
npm run lint
```

## üìä Database Schema

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡πÉ‡∏ä‡πâ Prisma ORM ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ database schema

‡∏î‡∏π schema ‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà: `prisma/schema.prisma`

### Main Models
- **User** - ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
- **Customer** - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
- **Lead** - Leads ‡∏à‡∏≤‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ï‡πà‡∏≤‡∏á‡πÜ
- **Trip** - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏¥‡∏õ
- **Booking** - ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á
- **Payment** - ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
- **Commission** - Commission
- **Task** - ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥
- **Notification** - ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô

## üîÑ Workflow

### Booking Flow
1. ‡∏™‡∏£‡πâ‡∏≤‡∏á Lead ‡∏à‡∏≤‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ï‡πà‡∏≤‡∏á‡πÜ
2. Convert Lead ‡πÄ‡∏õ‡πá‡∏ô Booking
3. ‡∏™‡∏£‡πâ‡∏≤‡∏á Payment (First Payment)
4. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Payment Status
5. Commission ‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠ FULLY_PAID

### Lead Status Sync
- Lead status ‡∏à‡∏∞ sync ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å Booking status
- BOOKED: ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ booking ‡∏ó‡∏µ‡πà DEPOSIT_PAID ‡∏´‡∏£‡∏∑‡∏≠ FULLY_PAID
- COMPLETED: ‡πÄ‡∏°‡∏∑‡πà‡∏≠ booking ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏õ‡πá‡∏ô FULLY_PAID
- CANCELLED: ‡πÄ‡∏°‡∏∑‡πà‡∏≠ booking ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏õ‡πá‡∏ô CANCELLED

## üêõ Troubleshooting

### Database Connection Issues
```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ PostgreSQL ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà
docker-compose ps

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö connection string ‡πÉ‡∏ô .env.local
DATABASE_URL="postgresql://user:password@localhost:5432/dbname"
```

### Prisma Issues
```bash
# Reset Prisma Client
npm run prisma:generate

# Reset database (‚ö†Ô∏è ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)
npm run prisma:reset
```

### Build Issues
```bash
# Clear Next.js cache
rm -rf .next

# Reinstall dependencies
rm -rf node_modules package-lock.json
npm install
```

## üìù License

[‡∏£‡∏∞‡∏ö‡∏∏ license ‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ]

## üë• Contributors

[‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ contributors]

## üìû Support

‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î issue ‡πÉ‡∏ô repository

---

**Note:** ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤ ‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á API ‡πÅ‡∏•‡∏∞ schema ‡πÑ‡∏î‡πâ
